# Custom Suricata rules for GameHub

# Web application security rules
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"GameHub: SQL Injection attempt detected"; flow:established,to_server; content:"SELECT"; nocase; content:"FROM"; nocase; distance:0; within:100; classtype:web-application-attack; sid:1000001; rev:1;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"GameHub: XSS attempt detected"; flow:established,to_server; content:"<script"; nocase; classtype:web-application-attack; sid:1000002; rev:1;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"GameHub: Path traversal attempt"; flow:established,to_server; content:"../"; classtype:web-application-attack; sid:1000003; rev:1;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"GameHub: Command injection attempt"; flow:established,to_server; content:"|3B|"; content:"rm"; nocase; distance:0; within:50; classtype:web-application-attack; sid:1000004; rev:1;)

# Banking service specific rules
alert http $EXTERNAL_NET any -> $HOME_NET 5001 (msg:"GameHub Bank: Unauthorized API access attempt"; flow:established,to_server; content:"POST"; http_method; content:"/api/transfer"; http_uri; content:!"Authorization:"; http_header; classtype:policy-violation; sid:1000010; rev:1;)

alert http $EXTERNAL_NET any -> $HOME_NET 5001 (msg:"GameHub Bank: Large transaction attempt"; flow:established,to_server; content:"amount"; http_client_body; content:"|22|1000000"; http_client_body; distance:0; within:20; classtype:policy-violation; sid:1000011; rev:1;)

# Store service specific rules  
alert http $EXTERNAL_NET any -> $HOME_NET 5000 (msg:"GameHub Store: Price manipulation attempt"; flow:established,to_server; content:"price"; http_client_body; content:"|22|0"; http_client_body; distance:0; within:20; classtype:policy-violation; sid:1000020; rev:1;)

alert http $EXTERNAL_NET any -> $HOME_NET 5000 (msg:"GameHub Store: Inventory manipulation"; flow:established,to_server; content:"quantity"; http_client_body; content:"|22|-"; http_client_body; distance:0; within:20; classtype:policy-violation; sid:1000021; rev:1;)

# Database protection rules
alert tcp $EXTERNAL_NET any -> $HOME_NET $DB_PORT (msg:"GameHub DB: Direct database access attempt"; flow:established,to_server; classtype:policy-violation; sid:1000030; rev:1;)

# Brute force protection
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"GameHub: Brute force login attempt"; flow:established,to_server; content:"POST"; http_method; content:"/login"; http_uri; detection_filter:track by_src, count 5, seconds 60; classtype:attempted-recon; sid:1000040; rev:1;)

# DDoS protection
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"GameHub: Potential DDoS attack"; flow:established,to_server; detection_filter:track by_src, count 100, seconds 10; classtype:attempted-dos; sid:1000050; rev:1;)

# Suspicious user agents
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"GameHub: Suspicious bot activity"; flow:established,to_server; content:"User-Agent|3A 20|"; http_header; content:"bot"; nocase; http_header; classtype:policy-violation; sid:1000060; rev:1;)

# File upload security
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"GameHub: Malicious file upload attempt"; flow:established,to_server; content:"Content-Type|3A 20|application/x-executable"; http_header; classtype:trojan-activity; sid:1000070; rev:1;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"GameHub: PHP file upload attempt"; flow:established,to_server; content:"filename|3D 22|"; http_header; content:".php"; nocase; http_header; distance:0; within:100; classtype:web-application-attack; sid:1000071; rev:1;)
